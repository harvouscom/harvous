---
import FaXmarkIcon from "@fortawesome/fontawesome-free/svgs/solid/xmark.svg";
import CircleCheck from "@fortawesome/fontawesome-free/svgs/solid/circle-check.svg";
import TriangleExclamationIcon from "@fortawesome/fontawesome-free/svgs/solid/triangle-exclamation.svg";
---

<div 
  x-data="{
    showToast: false,
    message: '',
    type: 'success',
    makeToast(message, type = 'success') {
      this.message = message;
      this.type = type;
      this.showToast = true;
      
      // Auto-hide toast after 4 seconds (longer for better visibility)
      setTimeout(() => {
        this.showToast = false;
      }, 4000);
    },
    dismissToast() {
      this.showToast = false;
    }
  }"
  x-cloak
  x-show="showToast"
  class="fixed rounded-xl shadow-toast top-3 left-4 right-4 mx-auto max-w-md z-50 will-change-[translate]"
  x-transition:enter="transition ease-in-out duration-500"
  x-transition:enter-start="transform !shadow-none translate-y-[-200%]"
  x-transition:enter-end="transform translate-y-0"
  x-transition:leave="transition ease-in-out duration-500"
  x-transition:leave-start="transform translate-y-0"
  x-transition:leave-end="transform !shadow-none translate-y-[-200%]"
  @toast.window="console.log('Toast event received:', $event.detail); makeToast($event.detail.message || 'Notification', $event.detail.type || 'success')"
>
  <div 
    role="alert"
    x-bind:data-type="type"
    class="toast-card text-[var(--color-deep-grey)] rounded-xl flex items-center gap-3 px-5 py-2"
    style="background: linear-gradient(168.707deg, rgba(255, 255, 255, 0.8) 11.711%, rgb(248, 248, 248) 71.325%);"
  >
    <!-- Icon -->
    <div class="flex-shrink-0">
      <!-- Success icon with circle background -->
      <div x-show="type === 'success'" class="w-5 h-5 rounded-full bg-[var(--color-deep-grey)] flex items-center justify-center">
        <img src={CircleCheck.src} alt="Success" class="w-3 h-3" style="filter: brightness(0) invert(1);" />
      </div>
      
      <!-- Error icon with triangle background -->
      <div x-show="type === 'error'" class="w-5 h-5 rounded-full bg-[var(--color-red)] flex items-center justify-center">
        <img src={TriangleExclamationIcon.src} alt="Error" class="w-3 h-3" style="filter: brightness(0) invert(1);" />
      </div>
    </div>

    <!-- Message -->
    <div class="flex-1">
      <p 
        class="font-sans font-semibold text-[18px] leading-[100%]"
        :class="{ 'text-[var(--color-red)]': type === 'error' }"
        x-text="message"
      ></p>
    </div>

    <!-- Close button -->
    <button
      class="flex-shrink-0"
      @click="dismissToast()"
      aria-label="Close notification"
    >
      {/* @ts-ignore */}
      <FaXmarkIcon class="w-5 h-5 transition-colors" :class="{ 'fill-[var(--color-red)]': type === 'error' }" />
    </button>
  </div>
</div>

<style>
  .shadow-toast {
    box-shadow: 
      0px 7px 16px 0px rgba(0, 0, 0, 0.1),
      0px 30px 30px 0px rgba(0, 0, 0, 0.09),
      0px 67px 40px 0px rgba(0, 0, 0, 0.05),
      0px 119px 47px 0px rgba(0, 0, 0, 0.01),
      0px 185px 52px 0px rgba(0, 0, 0, 0);
  }
</style>