---
import NavigationColumn from "./react/navigation/NavigationColumn.tsx";
import { NavigationProvider } from "./react/navigation/NavigationContext.tsx";

interface Props {
  inboxCount?: number;
  spaces?: Array<{
    id: string;
    title: string;
    totalItemCount: number;
    backgroundGradient: string;
  }>;
  activeThread?: {
    id: string;
    title: string;
    noteCount: number;
    backgroundGradient: string;
  } | null;
  currentSpace?: {
    id: string;
  } | null;
  isNote?: boolean;
  currentId?: string;
  showProfile?: boolean;
  initials?: string;
  userColor?: string;
  pathname?: string;
  [key: `data-${string}`]: string | number | undefined;
}

const { 
  inboxCount = 0,
  spaces = [],
  activeThread = null,
  currentSpace = null,
  isNote = false,
  currentId = null,
  showProfile = false,
  initials = "DJ",
  userColor = "paper",
  pathname = Astro.url.pathname,
  ...rest
} = Astro.props;

// Extract data-* attributes from rest props
const dataAttributes: Record<string, string | number> = {};
Object.keys(rest).forEach(key => {
  if (key.startsWith('data-')) {
    const value = (rest as Record<string, string | number | undefined>)[key];
    if (value !== undefined) {
      dataAttributes[key] = value;
    }
  }
});
---

<div {...dataAttributes} slot="navigation" class="h-full">
  <NavigationProvider client:load>
    <NavigationColumn 
      inboxCount={inboxCount}
      spaces={spaces}
      activeThread={activeThread}
      currentSpace={currentSpace}
      isNote={isNote}
      currentId={currentId || undefined}
      showProfile={showProfile}
      initials={initials}
      userColor={userColor}
      pathname={pathname}
    />
  </NavigationProvider>
</div>
