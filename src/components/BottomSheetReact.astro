---
import BottomSheet from './react/BottomSheet';
import packageJson from '../../package.json';

export interface Props {
  isOpen?: boolean;
  onClose?: () => void;
  title?: string;
  currentThread?: any;
  currentSpace?: any;
  currentNote?: any;
  contentType?: "thread" | "note" | "space" | "dashboard" | "profile";
}

const { 
  isOpen = false, 
  onClose, 
  title = "Panel", 
  currentThread,
  currentSpace,
  currentNote,
  contentType = "dashboard"
} = Astro.props;
---

<div class="min-[1160px]:hidden">
  <BottomSheet 
    isOpen={isOpen}
    onClose={onClose}
    title={title}
    currentThread={currentThread}
    currentSpace={currentSpace}
    currentNote={currentNote}
    contentType={contentType}
    version={packageJson.version}
    client:only="react"
  />
</div>

<style>
  /* Prevent body scroll when bottom sheet is open */
  body.bottom-sheet-open {
    overflow: hidden;
  }
  
  /* Mobile-specific styles - bottom sheet only shows on mobile */
  @media (max-width: 1159px) {
    .bottom-sheet {
      display: block;
    }
  }
  
  /* Completely hidden on desktop */
  @media (min-width: 1160px) {
    .bottom-sheet {
      display: none !important;
    }
  }
  
  /* Bottom sheet content container */
  .bottom-sheet .panel-container {
    height: auto;
    overflow-y: auto;
    flex: 1;
    min-height: 0;
  }
  
  /* Custom bottom sheet animations - Mobile only */
  @media (max-width: 1159px) {
    /* Bottom sheet content animation */
    .bottom-sheet-content {
      transform: translateY(100%) !important;
      transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1) !important;
    }
    
    /* Overlay fade animation - imperceptible timing */
    .bottom-sheet [data-radix-sheet-overlay] {
      opacity: 0;
      transition: opacity 0.6s ease-out;
    }
    
    .bottom-sheet [data-state="open"][data-radix-sheet-overlay] {
      opacity: 0.4;
    }
    
    .bottom-sheet [data-state="closed"][data-radix-sheet-overlay] {
      opacity: 0;
      transition: opacity 0.4s ease-in;
    }
  }
  
  /* Mobile viewport handling for better button visibility */
  @supports (height: 100dvh) {
    .bottom-sheet .drawer-panel {
      height: 90dvh !important;
    }
  }
  
  /* Fallback for browsers that don't support dvh */
  @supports not (height: 100dvh) {
    .bottom-sheet .drawer-panel {
      height: calc(90vh - env(safe-area-inset-bottom, 0px)) !important;
    }
  }
  
  /* Remove all focus outlines and blue borders from bottom sheet */
  @media (max-width: 1159px) {
    /* Remove focus outline from SheetContent itself */
    [data-radix-dialog-content] {
      outline: none !important;
      box-shadow: none !important;
    }
    
    /* Remove focus outlines from all elements inside bottom sheet - comprehensive coverage */
    [data-radix-dialog-content] *:focus,
    [data-radix-dialog-content] *:focus-visible,
    [data-radix-dialog-content] *:focus-within,
    [data-radix-dialog-content] *:active:focus,
    [data-radix-dialog-content] *:active:focus-visible {
      outline: none !important;
      box-shadow: none !important;
      border-color: inherit !important;
    }
    
    /* Remove focus ring styles that might show blue borders */
    [data-radix-dialog-content] *:focus-visible {
      outline: none !important;
      box-shadow: none !important;
      ring-width: 0 !important;
      ring-color: transparent !important;
    }
    
    /* Ensure no focus styles on interactive elements - comprehensive list */
    [data-radix-dialog-content] button:focus,
    [data-radix-dialog-content] button:focus-visible,
    [data-radix-dialog-content] button:active:focus,
    [data-radix-dialog-content] input:focus,
    [data-radix-dialog-content] input:focus-visible,
    [data-radix-dialog-content] input:active:focus,
    [data-radix-dialog-content] textarea:focus,
    [data-radix-dialog-content] textarea:focus-visible,
    [data-radix-dialog-content] textarea:active:focus,
    [data-radix-dialog-content] select:focus,
    [data-radix-dialog-content] select:focus-visible,
    [data-radix-dialog-content] select:active:focus,
    [data-radix-dialog-content] [contenteditable]:focus,
    [data-radix-dialog-content] [contenteditable]:focus-visible,
    [data-radix-dialog-content] [contenteditable]:active:focus,
    [data-radix-dialog-content] a:focus,
    [data-radix-dialog-content] a:focus-visible,
    [data-radix-dialog-content] a:active:focus {
      outline: none !important;
      box-shadow: none !important;
      border-color: inherit !important;
      ring-width: 0 !important;
      ring-color: transparent !important;
    }
    
    /* Remove any blue focus borders from Radix UI */
    [data-radix-dialog-content][data-focus-visible-added],
    [data-radix-dialog-content][data-focus-visible-added] * {
      outline: none !important;
      box-shadow: none !important;
    }
    
    /* Remove browser-specific focus styles (webkit, moz) */
    [data-radix-dialog-content] *::-webkit-focus-ring-color,
    [data-radix-dialog-content] *::-moz-focus-inner {
      outline: none !important;
      border: none !important;
    }
    
    /* Prevent any focus ring utilities from applying */
    [data-radix-dialog-content] .focus\:ring-0,
    [data-radix-dialog-content] .focus\:ring-transparent,
    [data-radix-dialog-content] .focus-visible\:ring-0 {
      ring-width: 0 !important;
      ring-color: transparent !important;
    }
  }
</style>
