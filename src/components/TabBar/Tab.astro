---
interface Props {
  label: string;
  href?: string;
  active?: boolean;
  closable?: boolean;
}

const { label, href, active = false, closable = false }: Props = Astro.props;

// Determine which localStorage item to remove based on the tab label
const storageKey = label === 'Note' ? 'lastViewedNote' : (label === 'Thread' ? 'lastViewedThread' : null);
---

{active ? (
  <div 
    class="relative rounded-t-lg px-5 h-[44px] flex items-center tab bg-(--color-soft-paper) cursor-pointer" 
    data-active={active} 
    role="tab"
  >
    <div class="flex items-center gap-2">
      <p class="tab-text w-fit font-sans font-bold text-sm text-(--color-stone-grey)">{label}</p>
      {closable && (
        <span 
          class="close-btn w-[12.5px] h-[12.5px] flex items-center justify-center text-[12px] font-bold leading-none text-(--color-stone-grey) cursor-pointer"
          onclick={`localStorage.removeItem('${storageKey}'); window.location.href='/dashboard'`}
        >×</span>
      )}
    </div>
  </div>
) : (
  <a 
    href={href} 
    role="tab" 
    class="relative rounded-t-lg px-5 h-[44px] flex items-center tab bg-(--color-fog-white)"
  >
    <div class="flex items-center gap-2">
      <p class="tab-text w-fit font-sans font-bold text-sm text-(--color-stone-grey)">{label}</p>
      {closable && (
        <span 
          class="close-btn w-[12.5px] h-[12.5px] flex items-center justify-center text-[12px] font-bold leading-none text-(--color-stone-grey) cursor-pointer"
          onclick={`localStorage.removeItem('${storageKey}'); window.location.href='/dashboard'`}
        >×</span>
      )}
    </div>
  </a>
)}

<style>
  .tab-text {
    text-box: trim-both cap alphabetic;
  }
  
  .close-btn {
    display: block;
    transform: scale(1.3);
  }
  
  /* Remove any default margins that could cause gaps */
  .tab {
    margin: 0;
  }
</style>