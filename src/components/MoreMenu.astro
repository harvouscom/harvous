---
import ThreadIcon from "@fortawesome/fontawesome-free/svgs/solid/layer-group.svg";
import NoteStickyIcon from "@fortawesome/fontawesome-free/svgs/solid/note-sticky.svg";
---

<div 
    class="more-menu bg-white rounded-xl shadow-[0px_3px_20px_0px_rgba(120,118,111,0.1)] overflow-hidden"
>
    <!-- New Thread Option -->
    <button 
        onclick="
          console.log('MoreMenu: New Thread button clicked');
          // Trigger new thread panel
          console.log('MoreMenu: Dispatching openNewThreadPanel event');
          try {
            window.dispatchEvent(new CustomEvent('openNewThreadPanel'));
          } catch (error) {
            console.error('Error dispatching openNewThreadPanel event:', error);
          }
          // Close the menu when any option is selected
          const threadParentContainer = this.closest('.square-button-container');
          if (threadParentContainer && threadParentContainer.__x) {
            threadParentContainer.__x.$data.isOpen = false;
          }
        "
        class="more-menu-item flex items-center gap-3 py-[18px] px-4 pb-5 hover:bg-gray-50 transition-colors duration-150 cursor-pointer w-full text-left"
    >
        <div class="relative shrink-0 w-5 h-5 flex items-center justify-center">
            <ThreadIcon class="fill-[var(--color-deep-grey)] block max-w-none w-full h-full" />
        </div>
        <span class="text-subtitle text-[var(--color-deep-grey)] whitespace-nowrap">
            New Thread
        </span>
    </button>
    
    <!-- New Note Option -->
    <button 
        onclick="
          console.log('MoreMenu: New Note button clicked');
          // Trigger new note panel
          console.log('MoreMenu: Dispatching openNewNotePanel event');
          try {
            window.dispatchEvent(new CustomEvent('openNewNotePanel'));
          } catch (error) {
            console.error('Error dispatching openNewNotePanel event:', error);
          }
          // Close the menu when any option is selected
          const parentContainer = this.closest('.square-button-container');
          if (parentContainer && parentContainer.__x) {
            parentContainer.__x.$data.isOpen = false;
          }
        "
        class="more-menu-item flex items-center gap-3 py-[18px] px-4 pb-5 hover:bg-gray-50 transition-colors duration-150 cursor-pointer w-full text-left"
    >
        <div class="relative shrink-0 w-5 h-5 flex items-center justify-center">
            <NoteStickyIcon class="fill-[var(--color-deep-grey)] block max-w-none w-full h-full" />
        </div>
        <span class="text-subtitle text-[var(--color-deep-grey)] whitespace-nowrap">
            New Note
        </span>
    </button>
</div>

<style>
    .more-menu {
        min-width: 223px;
    }
    
    .more-menu-item {
        border: none !important;
        outline: none !important;
    }
    
    .more-menu-item:first-child {
        border-radius: 12px 12px 0 0;
    }
    
    .more-menu-item:last-child {
        border-radius: 0 0 12px 12px;
    }
    
    .more-menu-item:only-child {
        border-radius: 12px;
    }
</style>
